
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>From a ContainerInterface to world domination - Matthieu Napoli</title>
  <meta name="author" content="Matthieu Napoli">

  
  <meta name="description" content="From a ContainerInterface to world domination Jan 14th, 2014 Ready for a stretch? This is an idea about dependency injection containers and an evil &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mnapoli.fr/from-containerinterface-to-world-domination">
  <link href="/favicon.ico" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Quicksand:300,400' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Matthieu Napoli" type="application/atom+xml">
  <script src="/js/jquery.js"></script>
  <script src="/js/bootstrap-collapse.js"></script>
  <script src="/js/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<script src="/js/jquery.timeago.js" type="text/javascript"></script>
<link href="/stylesheets/github.css" rel="stylesheet" type="text/css">
<link href="/stylesheets/custom.css" rel="stylesheet" type="text/css">

<script src="/js/underscore.min.js" type="text/javascript"></script>
<script src="/js/github-showcase/github.min.js" type="text/javascript"></script>
<link href="/js/github-showcase/github.min.css" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-15584647-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <div class="navbar navbar-inverse navbar-static-top">
  	<div class="navbar-inner">
  	  <div class="container">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-responsive-collapse">
          <span class="fui-menu-24"></span>
        </a>
  	  	<div class="nav-collapse collapse navbar-responsive-collapse" style="height:0;">
  	      <ul class="nav">
    
        <li ><a href="/">Home</a></li>
    
        <li ><a href="/projects/">Projects</a></li>
    
        <li ><a href="/presentations/">Talks</a></li>
    
        <li ><a href="/archives/">Blog archives</a></li>
    
        <li ><a href="/about-me/">About me</a></li>
    
        <li ><a href="/atom.xml"><i class='icon-rss social-navbar'></i></a></li>
    
</ul>

<ul class="nav pull-right">
    
    <li><a href="http://github.com/mnapoli" title="Github Profile"><i class="icon-github-sign social-navbar"></i></a></li>
    
    
    <li><a href="http://linkedin.com/in/matthieunapoli" title="Linkedin Profile"><i class="icon-linkedin-sign social-navbar"></i></a></li>
    
    
    <li><a href="http://twitter.com/matthieunapoli" title="Twitter Profile"><i class="icon-twitter-sign social-navbar"></i></a></li>
    
    
    
    
</ul>

  	    </div>
  	  </div>
  	</div>
  </div>
  <div class="container" id="main">
    <div class="">
      <div id="content">
        <div>
<article class="hentry" role="article">
  

  <header>
  <div class="jumbotron">
    From a ContainerInterface to world domination
	<h5>








  


<i class="icon-calendar-empty"></i> <time datetime="2014-01-14T18:00:00+01:00" pubdate data-updated="true">Jan 14<span>th</span>, 2014</time></h5>
  </div>
</header>
  <div class="row-fluid">
    <div class="span12">
      <p>Ready for a stretch? This is an idea about dependency injection containers and an evil plan for world domination.
Well, maybe not world domination, but crazy <strong>framework interoperability</strong> allowing one to <strong>use several frameworks in the same application</strong>.</p>

<!--more-->


<h2>ContainerInterface</h2>

<p>What I mean by <code>ContainerInterface</code> is a PHP interface that has been discussed here and there (PHP-FIG, Acclimate, PHP-DI, Mouf …) and that, after months of discussions and collective effort, has been standardized very recently thanks to the <a href="https://github.com/container-interop/container-interop">Container Interop</a> project.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">interface</span> <span class="nx">ContainerInterface</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">function</span> <span class="nf">get</span><span class="p">(</span><span class="nv">$identifier</span><span class="p">);</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">function</span> <span class="nf">has</span><span class="p">(</span><span class="nv">$identifier</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This interface <em>tries</em> to standardize the basic usage of a dependency injection container, or at least the usage made by a framework: reading entries from the container.</p>

<p>But what I also mean by <code>ContainerInterface</code> is what it represents: <strong>the basis for dependency injection containers interoperability</strong>.</p>

<p>Such an interface (or other derived interfaces) could allow to replace Framework A&rsquo;s container by another container. It could also allow to chain containers together, so that instead of replacing the framework&rsquo;s container, you could use 2, 3 or more containers at the same time.</p>

<h2>Why container interoperability?</h2>

<p>So, why should anyone care about <code>ContainerInterface</code> and all those abstract ideas?</p>

<h3>Choose your container</h3>

<p>The most obvious answer is simply that it let&rsquo;s you use <em>any</em> container. Just like <a href="https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-3-logger-interface.md">PSR-3</a> allowed you to choose your own logger, such an interface would allow you to look at all containers and choose the own you want based on their features.</p>

<p>And given containers are used both ways (set entries &amp; read entries), and that only the &ldquo;reading&rdquo; part needs standardization for interoperability (as meant by the previous section), that allows a lot of liberty on the &ldquo;set entries&rdquo; part.</p>

<p>For example, Symfony&rsquo;s container uses a YAML file to define services, whereas it&rsquo;s plain PHP for Zend Framework&rsquo;s container. PHP-DI allows configuration files, but also proposes autowiring and annotations. So there&rsquo;s choice.</p>

<h3>Portable configurations</h3>

<p>Allowing one to use <em>any</em> container in <em>any</em> framework is a very cool idea.</p>

<p>But the coolest thing IMO is most certainly that you can write <em>portable</em> configurations. Maybe the term is not right, but what I mean is that the container configuration you wrote for your Symfony app is also readable by your ZF app.</p>

<h2>The container at the center of your application</h2>

<p>The thing is that your container configuration is actually your application configuration. Configuring your logger, you DB layer, your email services, your domain services, … All of this can be done through a container.</p>

<p>And the day you want to use Laravel instead of ZF, you may still want to use the same logger, the same DB layer, the same email services and you would still want to have your domain services configured. Having to rewrite all that configuration is a pain, and it doesn&rsquo;t make sense.</p>

<p>This is how your application should look:</p>

<p><img class="center" src="/images/posts/application-structure.png"></p>

<p>The left part is coupled to the framework, which is obvious. The right part shouldn&rsquo;t.
It should use dependency injection and interfaces to abstract away from the components you use (ORM, loggers, mailers, …).
The container is here to bind everything together, and make all this available in the controllers.</p>

<p>So your container and</p>

<h2>Bundles are cool, interoperability is cooler</h2>

<p>Symfony offers the concept of <em>bundles</em>, which is basically a way to distribute an application module (admin back-end, user login/logout pages, …). You can then integrate this module to your application in a few seconds. And this is awesome.</p>

<p>But I find it too bad that to take advantage of these bundles, you have to write you application using Symfony. Same if you want to write bundles: you have to use Symfony.</p>

<p>Wouldn&rsquo;t it be great if anybody could write application modules in their framework of choice, and have them usable with any other framework? The &ldquo;bundle&rdquo; or module would only have its routing/controller layer coupled with the underlying framework. It could provide framework-agnostic models or services for you to use in your other modules.</p>

<p>To make these models and services available throughout the application, the module would come with its container and its configuration. The module&rsquo;s container could be chained to the application&rsquo;s container for example (and we are back on container interoperability).</p>

<h2>World domination</h2>

<p>So, to conclude, what do I mean by <em>world domination</em>? Of course, not actual world domination, but some sort of holy grail of a state where:</p>

<blockquote><p>you can divide your application in modules using different frameworks</p></blockquote>

<p>That&rsquo;s extremely seducing:</p>

<ul>
<li>different teams could write different modules with their own preferred technologies. For example, a micro-framework for the front-end, a full-stack framework for the backend</li>
<li>in the same vein, you could integrate in one application modules developed by different teams/companies (outsourcing?) that used different frameworks</li>
<li>you could upgrade/migrate to another framework bit by bit instead of rewriting your application in one big step (or instead of never doing it because it&rsquo;s too much work)</li>
<li>you could write/use small independent modules like Symfony&rsquo;s bundles, except that you wouldn&rsquo;t have to use Symfony to use them</li>
</ul>


<p>For this to work, you would have to have an entry point that dispatches a request to the correct framework (this sounds like a router). Something like this could be done using <a href="http://stackphp.com/">Stack</a> and a &ldquo;router&rdquo; middleware for example.</p>

<p><img src="/images/posts/container-interop.png"></p>

    </div>
  </div>



  <footer>
    <hr>
    
    <div class="row-fluid">
      
      <div class="span6">
        <p class="meta">
        
        



  <a href="/categories/dependency-injection/"><span class="badge">dependency-injection</span></a>

  <a href="/categories/open-source/"><span class="badge">open-source</span></a>

  <a href="/categories/php/"><span class="badge">php</span></a>




        </p>
      </div>
      
      <div class="span6 social-sharing">
        <div class="sharing">
  <div class="addthis_toolbox addthis_default_style ">
  
  
  <a class="addthis_button_tweet"></a>
  
  
  <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>

      </div>
      
      
    </div>
    
    <div class="row-fluid">
      <div class="span12">
        <p class="meta">
          
            <a class="basic-alignment left" href="/working-with-mails-in-dev-environment/" title="Previous Post: Working with mails in dev environment">&laquo; Working with mails in dev environment</a>
          
          
            <a class="basic-alignment right" href="/repository-interface/" title="Next Post: The Repository interface">The Repository interface &raquo;</a>
          
        </p>
      </div>
    </div>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>



      </div>
    </div>
    <div class="">
      <footer class="footer-page" role="contentinfo">
        <p>
  Copyright &copy; 2015 - Matthieu Napoli -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span> - Theme by <a href="http://alexgaribay.com">Alex Garibay</a>
</p>

<!-- Piwik -->
<script type="text/javascript">
    var _paq = _paq || [];
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
        var u=(("https:" == document.location.protocol) ? "https" : "http") + "://piwik.mnapoli.fr/";
        _paq.push(['setTrackerUrl', u+'piwik.php']);
        _paq.push(['setSiteId', 1]);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript';
        g.defer=true; g.async=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
    })();
</script>
<noscript><p><img src="http://piwik.mnapoli.fr/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
<!-- End Piwik Code -->


      </footer>
    </div>
  </div>
  

<script type="text/javascript">
      var disqus_shortname = 'mnapoli-blog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://mnapoli.fr/from-containerinterface-to-world-domination/';
        var disqus_url = 'http://mnapoli.fr/from-containerinterface-to-world-domination/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
